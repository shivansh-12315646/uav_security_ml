{% extends "base.html" %}

{% block title %}Analytics - UAV Security ML System{% endblock %}

{% block extra_css %}
<style>
.analytics-header {
    margin-bottom: 30px;
}

.analytics-header h1 {
    color: #667eea;
    margin-bottom: 10px;
}

/* Dataset Statistics */
.dataset-stats {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
    border: 1px solid rgba(102, 126, 234, 0.2);
}

.dataset-stats h2 {
    color: #667eea;
    margin-bottom: 25px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.stat-box {
    background: #0f172a;
    padding: 20px;
    border-radius: 10px;
    border-left: 4px solid #667eea;
}

.stat-box h4 {
    color: #94a3b8;
    font-size: 0.9rem;
    margin-bottom: 10px;
}

.stat-box .value {
    font-size: 2rem;
    font-weight: 700;
    color: #667eea;
}

.stat-box .subtext {
    font-size: 0.85rem;
    opacity: 0.7;
    margin-top: 5px;
}

/* Charts Container */
.chart-container {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
    border: 1px solid rgba(102, 126, 234, 0.2);
}

.chart-container h3 {
    color: #667eea;
    margin-bottom: 20px;
}

/* Model Comparison Cards */
.model-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.model-card {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 15px;
    padding: 25px;
    border: 1px solid rgba(102, 126, 234, 0.2);
    transition: all 0.3s ease;
}

.model-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    border-color: rgba(102, 126, 234, 0.5);
}

.model-card h3 {
    color: #667eea;
    margin-bottom: 20px;
    font-size: 1.3rem;
}

.metric-row {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.metric-row:last-child {
    border-bottom: none;
}

.metric-label {
    color: #94a3b8;
}

.metric-value {
    font-weight: 700;
    color: #667eea;
}

/* Feature Importance */
.feature-bar {
    margin-bottom: 15px;
}

.feature-bar-label {
    display: flex;
    justify-content: space-between;
    margin-bottom: 5px;
}

.feature-bar-fill {
    height: 30px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 5px;
    transition: width 1s ease;
    display: flex;
    align-items: center;
    padding-left: 10px;
    color: white;
    font-weight: 600;
}

/* Processing Metrics */
.metrics-panel {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
    border: 1px solid rgba(102, 126, 234, 0.2);
}

.metrics-panel h3 {
    color: #667eea;
    margin-bottom: 20px;
}

.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.metric-item {
    background: #0f172a;
    padding: 15px;
    border-radius: 8px;
    border-left: 3px solid #667eea;
}

.metric-item .icon {
    font-size: 1.5rem;
    color: #667eea;
    margin-bottom: 10px;
}

.metric-item .label {
    font-size: 0.85rem;
    color: #94a3b8;
    margin-bottom: 5px;
}

.metric-item .value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #667eea;
}
</style>
{% endblock %}

{% block content %}
<div class="analytics-header" data-aos="fade-down">
    <h1><i class="fas fa-chart-line"></i> Analytics Dashboard</h1>
    <p style="opacity: 0.8;">Comprehensive analysis of UAV security data and ML model performance</p>
</div>

<!-- Dataset Statistics Overview -->
<div class="dataset-stats" data-aos="fade-up">
    <h2><i class="fas fa-database"></i> Dataset Statistics Overview</h2>
    
    <div class="stats-grid">
        <div class="stat-box">
            <h4>üì¶ Total Data Points</h4>
            <div class="value">15,847</div>
        </div>
        
        <div class="stat-box">
            <h4>‚úÖ Normal Traffic</h4>
            <div class="value">12,341</div>
            <div class="subtext">77.9% of total</div>
        </div>
        
        <div class="stat-box">
            <h4>üö® Threat Samples</h4>
            <div class="value">3,506</div>
            <div class="subtext">22.1% of total</div>
        </div>
    </div>
    
    <h3 style="color: #667eea; margin-top: 30px; margin-bottom: 20px;">Feature Statistics</h3>
    <div class="stats-grid">
        <div class="stat-box">
            <h4>Packet Size</h4>
            <div class="value" style="font-size: 1.3rem;">512 bytes</div>
            <div class="subtext">Mean ¬± 245 Std</div>
        </div>
        
        <div class="stat-box">
            <h4>Inter-Arrival</h4>
            <div class="value" style="font-size: 1.3rem;">45 ms</div>
            <div class="subtext">Mean ¬± 28 Std</div>
        </div>
        
        <div class="stat-box">
            <h4>Packet Rate</h4>
            <div class="value" style="font-size: 1.3rem;">850 pkt/s</div>
            <div class="subtext">Mean ¬± 420 Std</div>
        </div>
        
        <div class="stat-box">
            <h4>Duration</h4>
            <div class="value" style="font-size: 1.3rem;">120 sec</div>
            <div class="subtext">Mean ¬± 65 Std</div>
        </div>
        
        <div class="stat-box">
            <h4>Failed Logins</h4>
            <div class="value" style="font-size: 1.3rem;">2</div>
            <div class="subtext">Mean ¬± 5 Std</div>
        </div>
    </div>
</div>

<!-- Model Performance Comparison -->
<h2 style="color: #667eea; margin-bottom: 20px;" data-aos="fade-up">
    <i class="fas fa-balance-scale"></i> Model Performance Comparison
</h2>

<div class="model-grid">
    <div class="model-card" data-aos="flip-left">
        <h3><i class="fas fa-tree"></i> Random Forest</h3>
        <div class="metric-row">
            <span class="metric-label">Accuracy</span>
            <span class="metric-value">96.8%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Precision</span>
            <span class="metric-value">95.2%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Recall</span>
            <span class="metric-value">97.1%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">F1-Score</span>
            <span class="metric-value">96.1%</span>
        </div>
    </div>
    
    <div class="model-card" data-aos="flip-left" data-aos-delay="100">
        <h3><i class="fas fa-bolt"></i> XGBoost</h3>
        <div class="metric-row">
            <span class="metric-label">Accuracy</span>
            <span class="metric-value">97.2%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Precision</span>
            <span class="metric-value">96.1%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Recall</span>
            <span class="metric-value">96.8%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">F1-Score</span>
            <span class="metric-value">96.4%</span>
        </div>
    </div>
    
    <div class="model-card" data-aos="flip-left" data-aos-delay="200">
        <h3><i class="fas fa-project-diagram"></i> SVM</h3>
        <div class="metric-row">
            <span class="metric-label">Accuracy</span>
            <span class="metric-value">94.5%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Precision</span>
            <span class="metric-value">93.8%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Recall</span>
            <span class="metric-value">95.2%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">F1-Score</span>
            <span class="metric-value">94.5%</span>
        </div>
    </div>
    
    <div class="model-card" data-aos="flip-left" data-aos-delay="300">
        <h3><i class="fas fa-network-wired"></i> Neural Network</h3>
        <div class="metric-row">
            <span class="metric-label">Accuracy</span>
            <span class="metric-value">95.8%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Precision</span>
            <span class="metric-value">94.9%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">Recall</span>
            <span class="metric-value">96.2%</span>
        </div>
        <div class="metric-row">
            <span class="metric-label">F1-Score</span>
            <span class="metric-value">95.5%</span>
        </div>
    </div>
</div>

<!-- Feature Importance Chart -->
<div class="chart-container" data-aos="fade-up">
    <h3><i class="fas fa-sliders-h"></i> Feature Importance Ranking</h3>
    
    <div class="feature-bar">
        <div class="feature-bar-label">
            <span>Failed Logins</span>
            <span style="color: #667eea; font-weight: 700;">34.2%</span>
        </div>
        <div class="feature-bar-fill" style="width: 100%;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</div>
    </div>
    
    <div class="feature-bar">
        <div class="feature-bar-label">
            <span>Packet Rate</span>
            <span style="color: #667eea; font-weight: 700;">28.7%</span>
        </div>
        <div class="feature-bar-fill" style="width: 84%;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</div>
    </div>
    
    <div class="feature-bar">
        <div class="feature-bar-label">
            <span>Inter-Arrival Time</span>
            <span style="color: #667eea; font-weight: 700;">18.5%</span>
        </div>
        <div class="feature-bar-fill" style="width: 54%;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</div>
    </div>
    
    <div class="feature-bar">
        <div class="feature-bar-label">
            <span>Packet Size</span>
            <span style="color: #667eea; font-weight: 700;">12.3%</span>
        </div>
        <div class="feature-bar-fill" style="width: 36%;">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</div>
    </div>
    
    <div class="feature-bar">
        <div class="feature-bar-label">
            <span>Duration</span>
            <span style="color: #667eea; font-weight: 700;">6.3%</span>
        </div>
        <div class="feature-bar-fill" style="width: 18%;">‚ñà‚ñà‚ñà</div>
    </div>
</div>

<!-- Algorithm Accuracy Chart -->
<div class="chart-container" data-aos="fade-up">
    <h3><i class="fas fa-chart-bar"></i> Algorithm Accuracy Comparison</h3>
    <canvas id="accuracyChart"></canvas>
</div>

<!-- Time-Series Analysis -->
<div class="chart-container" data-aos="fade-up">
    <h3><i class="fas fa-chart-area"></i> Threat Detection Trends (Last 30 Days)</h3>
    <canvas id="trendChart"></canvas>
</div>

<!-- Feature Distribution -->
<div class="chart-container" data-aos="fade-up">
    <h3><i class="fas fa-chart-pie"></i> Feature Distribution Analysis</h3>
    <canvas id="distributionChart"></canvas>
</div>

<!-- Real-Time Processing Metrics -->
<div class="metrics-panel" data-aos="fade-up">
    <h3><i class="fas fa-tachometer-alt"></i> Real-Time Processing Metrics</h3>
    
    <div class="metrics-grid">
        <div class="metric-item">
            <div class="icon">‚ö°</div>
            <div class="label">Points Processed Today</div>
            <div class="value" id="points-processed">0</div>
        </div>
        
        <div class="metric-item">
            <div class="icon">üöÄ</div>
            <div class="label">Processing Speed</div>
            <div class="value">1,247 <span style="font-size: 0.8rem;">pkt/s</span></div>
        </div>
        
        <div class="metric-item">
            <div class="icon">üìä</div>
            <div class="label">Current Queue</div>
            <div class="value">23 <span style="font-size: 0.8rem;">pending</span></div>
        </div>
        
        <div class="metric-item">
            <div class="icon">‚è±Ô∏è</div>
            <div class="label">Average Latency</div>
            <div class="value">12 <span style="font-size: 0.8rem;">ms</span></div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="/static/js/charts.js"></script>
<script>
// CountUp for points processed
window.addEventListener('load', function() {
    var pointsCounter = new CountUp('points-processed', 0, 8473, 0, 2, {
        useEasing: true,
        useGrouping: true,
        separator: ','
    });
    if (!pointsCounter.error) {
        pointsCounter.start();
    }
});

// Time-Series Trend Chart
const trendCtx = document.getElementById('trendChart');
if (trendCtx) {
    new Chart(trendCtx, {
        type: 'line',
        data: {
            labels: ['Day 1', 'Day 5', 'Day 10', 'Day 15', 'Day 20', 'Day 25', 'Day 30'],
            datasets: [{
                label: 'Threats Detected',
                data: [45, 52, 48, 65, 59, 70, 63],
                borderColor: '#dc2626',
                backgroundColor: 'rgba(220, 38, 38, 0.1)',
                fill: true,
                tension: 0.4
            }, {
                label: 'Normal Traffic',
                data: [455, 478, 492, 485, 501, 490, 507],
                borderColor: '#10b981',
                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: { color: '#e5e7eb' }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: '#e5e7eb' },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                },
                x: {
                    ticks: { color: '#e5e7eb' },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                }
            }
        }
    });
}

// Feature Distribution Chart
const distCtx = document.getElementById('distributionChart');
if (distCtx) {
    new Chart(distCtx, {
        type: 'bar',
        data: {
            labels: ['Packet Size', 'Inter-Arrival', 'Packet Rate', 'Duration', 'Failed Logins'],
            datasets: [{
                label: 'Normal Traffic',
                data: [485, 512, 430, 502, 95],
                backgroundColor: 'rgba(16, 185, 129, 0.7)',
                borderColor: '#10b981',
                borderWidth: 1
            }, {
                label: 'Threat Traffic',
                data: [892, 1245, 1580, 345, 1890],
                backgroundColor: 'rgba(220, 38, 38, 0.7)',
                borderColor: '#dc2626',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: { color: '#e5e7eb' }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: '#e5e7eb' },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                },
                x: {
                    ticks: { color: '#e5e7eb' },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                }
            }
        }
    });
}
</script>
{% endblock %}

