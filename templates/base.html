<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}UAV Security ML System{% endblock %}</title>
    
    <!-- Font Awesome 6 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" 
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" 
          crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- AOS Animation -->
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet"
          integrity="sha512-1cK78a1o+ht2JcaW6g8OXYwqpev9+6GqOkz9xmBN9iUUhIndKtxwILGWYOSibOKjLsEdjyjZvYDq/cZwNeak0w==" 
          crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Bootstrap 5 (Optional for components) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" 
          crossorigin="anonymous">
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="stylesheet" href="/static/css/sidebar.css">
    <link rel="stylesheet" href="/static/css/animations.css">
    
    {% block extra_css %}{% endblock %}
</head>
<body>

<!-- Enhanced Sidebar with Dropdown & Search -->
<div class="sidebar">
    <!-- Logo Header -->
    <div class="sidebar-header">
        <i class="fas fa-drone"></i>
        <h4>UAV Security</h4>
    </div>
    
    <!-- Search Box -->
    <div class="sidebar-search">
        <input type="text" id="nav-search" placeholder="ðŸ” Search navigation...">
    </div>
    
    <!-- Navigation Menu -->
    <ul class="sidebar-menu">
        <!-- Overview -->
        <li class="menu-item">
            <a href="/" class="menu-link">
                <i class="fas fa-home"></i> Overview
            </a>
        </li>
        
        <!-- Detection (Dropdown) -->
        <li class="menu-item has-dropdown">
            <a href="#" class="menu-link dropdown-toggle">
                <i class="fas fa-satellite-dish"></i> Detection
                <i class="fas fa-chevron-down arrow"></i>
            </a>
            <ul class="submenu">
                <li><a href="/detect"><i class="fas fa-broadcast-tower"></i> Live Detection</a></li>
                <li><a href="/history"><i class="fas fa-history"></i> History</a></li>
            </ul>
        </li>
        
        <!-- Analytics -->
        <li class="menu-item">
            <a href="/analytics" class="menu-link">
                <i class="fas fa-chart-line"></i> Analytics
            </a>
        </li>
        
        <!-- ML Models (Dropdown) -->
        <li class="menu-item has-dropdown">
            <a href="#" class="menu-link dropdown-toggle">
                <i class="fas fa-robot"></i> ML Models
                <i class="fas fa-chevron-down arrow"></i>
            </a>
            <ul class="submenu">
                <li><a href="/algorithms"><i class="fas fa-brain"></i> Algorithms</a></li>
            </ul>
        </li>
    </ul>
    
    <!-- User Profile Footer -->
    <div class="sidebar-footer">
        <div class="user-profile">
            <div style="width: 45px; height: 45px; border-radius: 50%; margin-right: 12px; border: 2px solid white; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-user" style="font-size: 1.5rem;"></i>
            </div>
            <div class="user-info">
                <h5>Admin User</h5>
                <p>Administrator</p>
            </div>
        </div>
        <button class="btn" onclick="window.location.href='/logout'">
            <i class="fas fa-sign-out-alt"></i> Logout
        </button>
    </div>
</div>

<!-- Main Content Area -->
<div class="main-content">
    {% block content %}{% endblock %}
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>

<!-- Animation Libraries -->
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
<script src="https://cdn.jsdelivr.net/npm/countup@1.8.2/dist/countUp.min.js"></script>

<!-- Initialize AOS -->
<script>
    AOS.init({
        duration: 800,
        easing: 'ease-in-out',
        once: true
    });
</script>

<!-- Sidebar Functionality -->
<script>
    // Dropdown toggle functionality
    document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
        toggle.addEventListener('click', function(e) {
            e.preventDefault();
            const parent = this.closest('.menu-item');
            
            // Close other dropdowns
            document.querySelectorAll('.menu-item.open').forEach(item => {
                if (item !== parent) {
                    item.classList.remove('open');
                    const submenu = item.querySelector('.submenu');
                    if (submenu) submenu.style.maxHeight = '0';
                    const arrow = item.querySelector('.arrow');
                    if (arrow) arrow.style.transform = 'rotate(0deg)';
                }
            });
            
            // Toggle current dropdown
            parent.classList.toggle('open');
            
            const submenu = parent.querySelector('.submenu');
            const arrow = this.querySelector('.arrow');
            
            if (parent.classList.contains('open')) {
                submenu.style.maxHeight = '500px';
                arrow.style.transform = 'rotate(180deg)';
            } else {
                submenu.style.maxHeight = '0';
                arrow.style.transform = 'rotate(0deg)';
            }
        });
    });

    // Search functionality
    document.getElementById('nav-search').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        document.querySelectorAll('.menu-item').forEach(item => {
            const text = item.textContent.toLowerCase();
            item.style.display = text.includes(searchTerm) ? 'block' : 'none';
        });
    });
    
    // Highlight active page
    const currentPath = window.location.pathname;
    document.querySelectorAll('.menu-link, .submenu a').forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.classList.add('active');
            // Open parent dropdown if in submenu
            const parentDropdown = link.closest('.has-dropdown');
            if (parentDropdown) {
                parentDropdown.classList.add('open');
                const submenu = parentDropdown.querySelector('.submenu');
                const arrow = parentDropdown.querySelector('.arrow');
                if (submenu) submenu.style.maxHeight = '500px';
                if (arrow) arrow.style.transform = 'rotate(180deg)';
            }
        }
    });
</script>

{% block extra_js %}{% endblock %}

</body>
</html>
